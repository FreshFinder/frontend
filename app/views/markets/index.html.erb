<div class="logo">
  <h1>Fresh Finder</h1>
</div>

<div id="map"></div>
<!-- <div id='info'></div> -->

<script src="http://api.tiles.mapbox.com/mapbox.js/v1.6.1/mapbox.js"></script>
<link href="http://api.tiles.mapbox.com/mapbox.js/v1.6.1/mapbox.css" rel="stylesheet" />

<script>
jQuery(document).ready(function() {

 var mappy = L.mapbox.map("map", "rsoden.map-wjcj2udt").setView([40.52086, -100.679523], 5); 

 var marketData = "http://localhost:5555/api/v1/markets.json?address=true";
 $.getJSON( marketData, function( data ) {

  $.each(data, function(index, val) {
     var lng =  parseFloat(val.address.long),
     lat =  parseFloat(val.address.lat);
     
     var name = val.name;
     var id = val.id;

     var markerLayer = L.mapbox.markerLayer({
        type: 'Feature',
        geometry: {
          type: 'Point',
          coordinates: [lat, lng]
        },
        properties: {
          market_id: id,
          name: name,
          description: val.address.description,
          street: val.address.street,
          city: val.address.city,
          name: val.name,
          'marker-size': 'small',
          'marker-color': '#9CFF00'
        }
      }).addTo(mappy);
    
     markerLayer.eachLayer(function (layer) {
      console.log(layer.feature.properties);
      var content = '<h1>' + layer.feature.properties.name + '</h1>'
          '<h2>' + layer.feature.properties.street + ',' + layer.feature.properties.city + '<\/h2>' +
          '<h3>' + layer.feature.properties.description + ',' + '<\/h3>' ;
      layer.bindPopup(content);
      
  });
 });
});
});


</script>


 <!--  //  map.markerLayer.on('click',function(e) {
    
  //   var info = '<h2>' + street + '</h2>' +
  //   '<p>' + description + '</p>';
  //   document.getElementById('info').innerHTML = info;
  // });
  //  map.on('click',function(e){
  //   document.getElementById('info').innerHTML = '';
  // }); -->
